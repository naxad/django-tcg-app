{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}TCG Store{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'shop/style.css' %}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- ffor scrolling animation -->
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- AOS CSS -->
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <!-- Your CSS -->
    <link rel="stylesheet" href="{% static 'shop/style.css' %}">
    <!-- jQuery + AOS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>

    <!-- CSRF token for JS -->
    <script>
    const csrfToken = '{{ csrf_token }}';
    </script>

    <!-- Your JS -->
    <script src="{% static 'shop/scripts.js' %}"></script>

  </head>
  <body>
    <header>
      <h1>Welcome to the TCG Store</h1>
      <nav>
        <a href="{% url 'home' %}">Home</a>
        <a href="{% url 'browse' %}">Browse</a>
        <a href="{% url 'contact' %}">Contact</a>
        <a href="{% url 'sell' %}">Sell With Us</a>

        {% if user.is_authenticated %}
            <a href="{% url 'profile' %}">My Profile</a>
            {% if user.is_staff %}
                <a href="/admin/">Admin Panel</a>
            {% endif %}
            <a href="{% url 'logout' %}">Logout</a>
        {% else %}
            <a href="{% url 'login' %}">Login</a>
            <a href="{% url 'register' %}">Register</a>
        {% endif %}
      </nav>
      <form method="GET" action="{% url 'browse' %}" class="search-bar">
        <input type="text" name="q" placeholder="Search cards..." />
        <select name="brand">
          <option value="">All Brands</option>
          <option value="Pokemon">Pok√©mon</option>
          <option value="OnePiece">One Piece</option>
          <option value="MTG">Magic: The Gathering</option>
        </select>
        <button type="submit">üîç</button>
      </form>
    </header>

    <main>{% block content %}{% endblock %}</main>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.rating-stars .star').on('click', function () {
            const score = $(this).data('value');
            const cardId = $(this).parent().data('card');
            
            $.ajax({
                type: 'POST',
                url: '{% url "rate_card" %}',
                data: {
                card_id: cardId,
                score: score,
                csrfmiddlewaretoken: '{{ csrf_token }}'
                },
                success: function (response) {
                if (response.success) {
                    alert('Rating submitted!');
                    location.reload(); // optional: refresh to show update
                } else {
                    alert('Error: ' + response.error);
                }
                }
            });
            });
        });
    </script>
    <!-- scrolling  -->
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
    <script>
    AOS.init({
        duration: 600,
        easing: 'ease-out',
        once: true
    });
    </script>
  </body>
</html>
